# G1机器人集成说明

## 概述
本文档说明了如何在Rocksi卡片式编程仿真页面中添加Unitree G1人形机器人模型。

## 已完成的任务

### 1. 检查G1机器人描述文件
- ✅ 检查了g1_description文件夹中的所有描述文件
- ✅ 创建了适合Rocksi项目的URDF文件：`g1_29dof_rocksi.urdf`
- ✅ 添加了世界坐标系和浮动基座定义
- ✅ 确保所有mesh文件路径正确

### 2. 添加前端页面可选机器人选项
- ✅ 在HTML页面中添加了G1机器人选项
- ✅ 更新了机器人选择器的下拉菜单
- ✅ 修复了机器人选项值与JavaScript代码的匹配问题

### 3. 实现G1机器人加载功能
- ✅ 创建了G1机器人的JavaScript实现文件：`src/simulator/robots/g1.js`
- ✅ 创建了G1机器人的代码生成器：`src/editor/generators/g1.js`
- ✅ 更新了机器人索引文件：`src/simulator/robots/index.js`
- ✅ 更新了场景加载逻辑：`src/simulator/scene.js`

## 文件结构

```
Rocksi-master/
├── assets/models/g1_description/
│   ├── g1_29dof_rocksi.urdf          # 新创建的URDF文件
│   ├── meshes/                       # 3D模型文件
│   └── ...                           # 其他原始文件
├── src/simulator/robots/
│   ├── g1.js                         # G1机器人实现
│   └── index.js                      # 更新的机器人索引
├── src/editor/generators/
│   └── g1.js                         # G1代码生成器
├── src/simulator/scene.js            # 更新的场景加载逻辑
└── index.html                        # 更新的前端页面
```

## G1机器人特性

### 关节配置
- **腿部关节**：12个自由度（左右腿各6个）
  - 髋关节：pitch, roll, yaw
  - 膝关节：pitch
  - 踝关节：pitch, roll
- **躯干关节**：2个自由度
  - 腰部：yaw, roll
- **手臂关节**：12个自由度（左右臂各6个）
  - 肩关节：pitch, roll, yaw
  - 肘关节：pitch
  - 腕关节：roll, pitch, yaw

### 默认姿态
- 人形机器人站立姿态
- 所有关节角度设为0度
- 机器人高度约1.3米

### 功能特性
- ✅ 支持逆运动学控制
- ✅ 支持关节限制
- ✅ 支持物理引擎
- ✅ 支持代码生成（Python、ROS、C++）
- ✅ 支持多语言界面

## 测试方法

### 1. 启动项目
```bash
cd Rocksi-master
npm install
npm run dev
```

### 2. 选择G1机器人
1. 打开浏览器访问项目
2. 在右上角的机器人选择器中选择"G1"
3. 页面会自动重新加载并显示G1机器人

### 3. 验证功能
- ✅ 机器人模型正确加载
- ✅ 机器人站立在地面上
- ✅ 可以拖动关节进行控制
- ✅ 可以编写程序控制机器人
- ✅ 代码生成功能正常

## 技术细节

### URDF文件修改
- 添加了`<link name="world"/>`世界坐标系
- 添加了`floating_base_joint`浮动基座关节
- 保持了所有原始关节和链接结构
- 确保mesh文件路径正确

### JavaScript实现
- 继承自`Robot`基类
- 实现了人形机器人特有的方法
- 支持腿部、躯干、手臂的独立控制
- 提供了完整的关节配置

### 代码生成器
- 支持Python、ROS、C++代码生成
- 包含完整的关节控制接口
- 提供了ROS话题配置

## 注意事项

1. **模型尺寸**：G1机器人保持原始尺寸，可能需要调整视角
2. **关节限制**：所有关节都有合理的角度限制
3. **物理引擎**：启用了物理引擎，机器人会受重力影响
4. **性能**：人形机器人关节较多，可能需要更多计算资源

## 故障排除

### 常见问题
1. **机器人不显示**：检查URDF文件路径和mesh文件
2. **关节无法控制**：检查关节名称是否匹配
3. **加载错误**：检查浏览器控制台的错误信息

### 调试方法
1. 打开浏览器开发者工具
2. 查看控制台输出
3. 检查网络请求是否成功加载模型文件

## 后续改进

1. **优化模型**：可以进一步优化URDF文件结构
2. **添加动画**：可以实现行走、抓取等预设动画
3. **增强控制**：可以添加更高级的控制功能
4. **性能优化**：可以优化渲染和物理计算性能 